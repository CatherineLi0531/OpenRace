<!doctype html>
<html lang="en" dir="ltr">
<head>
<meta charset="UTF-8">
<meta name="viewport" content="width=device-width,initial-scale=1">
<meta name="generator" content="Docusaurus v2.0.0-alpha.73">
<link rel="alternate" type="application/rss+xml" href="/OpenRace/blog/rss.xml" title="Coderrect OpenRace Blog RSS Feed">
<link rel="alternate" type="application/atom+xml" href="/OpenRace/blog/atom.xml" title="Coderrect OpenRace Blog Atom Feed"><title data-react-helmet="true">Design Overview | Coderrect OpenRace</title><meta data-react-helmet="true" property="og:url" content="https://coderrect-inc.github.io/OpenRace/doc-overview"><meta data-react-helmet="true" name="docusaurus_locale" content="en"><meta data-react-helmet="true" name="docusaurus_version" content="current"><meta data-react-helmet="true" name="docusaurus_tag" content="docs-default-current"><meta data-react-helmet="true" property="og:title" content="Design Overview | Coderrect OpenRace"><meta data-react-helmet="true" name="description" content="The description of this program is split into two parts."><meta data-react-helmet="true" property="og:description" content="The description of this program is split into two parts."><link data-react-helmet="true" rel="shortcut icon" href="/OpenRace/img/coderrect-logo.png"><link data-react-helmet="true" rel="canonical" href="https://coderrect-inc.github.io/OpenRace/doc-overview"><link data-react-helmet="true" rel="alternate" href="https://coderrect-inc.github.io/OpenRace/doc-overview" hreflang="en"><link data-react-helmet="true" rel="alternate" href="https://coderrect-inc.github.io/OpenRace/doc-overview" hreflang="x-default"><link rel="stylesheet" href="/OpenRace/assets/css/styles.ed0b3173.css">
<link rel="preload" href="/OpenRace/assets/js/styles.e8a566df.js" as="script">
<link rel="preload" href="/OpenRace/assets/js/runtime~main.ba43cde6.js" as="script">
<link rel="preload" href="/OpenRace/assets/js/main.1a781497.js" as="script">
<link rel="preload" href="/OpenRace/assets/js/1.1431b613.js" as="script">
<link rel="preload" href="/OpenRace/assets/js/2.c28e7a27.js" as="script">
<link rel="preload" href="/OpenRace/assets/js/3.f253f854.js" as="script">
<link rel="preload" href="/OpenRace/assets/js/1be78505.ed6ce7d4.js" as="script">
<link rel="preload" href="/OpenRace/assets/js/21.1345832e.js" as="script">
<link rel="preload" href="/OpenRace/assets/js/935f2afb.fd86e8c5.js" as="script">
<link rel="preload" href="/OpenRace/assets/js/17896441.811aa758.js" as="script">
<link rel="preload" href="/OpenRace/assets/js/9415349f.d7a4d979.js" as="script">
</head>
<body>
<script>!function(){function t(t){document.documentElement.setAttribute("data-theme",t)}var e=function(){var t=null;try{t=localStorage.getItem("theme")}catch(t){}return t}();t(null!==e?e:"light")}()</script><div id="__docusaurus">
<div><a href="#main" class="skipToContent_1oUP">Skip to main content</a></div><nav class="navbar navbar--fixed-top"><div class="navbar__inner"><div class="navbar__items"><button aria-label="Navigation bar toggle" class="navbar__toggle" type="button" tabindex="0"><svg aria-label="Menu" width="30" height="30" viewBox="0 0 30 30" role="img" focusable="false"><title>Menu</title><path stroke="currentColor" stroke-linecap="round" stroke-miterlimit="10" stroke-width="2" d="M4 7h22M4 15h22M4 23h22"></path></svg></button><a class="navbar__brand" href="/OpenRace/"><img src="/OpenRace/img/coderrect-logo.png" alt="Coderrect OpenRace" class="themedImage_1VuW themedImage--light_3UqQ navbar__logo"><img src="/OpenRace/img/coderrect-logo.png" alt="Coderrect OpenRace" class="themedImage_1VuW themedImage--dark_hz6m navbar__logo"><strong class="navbar__title">Coderrect OpenRace</strong></a><a href="https://coderrect.com/blog/" target="_blank" rel="noopener noreferrer" class="navbar__item navbar__link">Blog</a></div><div class="navbar__items navbar__items--right"><a href="https://github.com/coderrect-inc/OpenRace" target="_blank" rel="noopener noreferrer" class="navbar__item navbar__link">GitHub</a><div class="react-toggle displayOnlyInLargeViewport_GrZ2 react-toggle--disabled" role="button" tabindex="-1"><div class="react-toggle-track"><div class="react-toggle-track-check"><span class="toggle_71bT">ðŸŒœ</span></div><div class="react-toggle-track-x"><span class="toggle_71bT">ðŸŒž</span></div></div><div class="react-toggle-thumb"></div><input type="checkbox" class="react-toggle-screenreader-only" aria-label="Switch between dark and light mode"></div><div class="navbar__search searchBarContainer_MM2z"><input placeholder="Search" aria-label="Search" class="navbar__search-input"><div class="loadingRing_s5VG searchBarLoadingRing_2jQk"><div></div><div></div><div></div><div></div></div></div></div></div><div role="presentation" class="navbar-sidebar__backdrop"></div><div class="navbar-sidebar"><div class="navbar-sidebar__brand"><a class="navbar__brand" href="/OpenRace/"><img src="/OpenRace/img/coderrect-logo.png" alt="Coderrect OpenRace" class="themedImage_1VuW themedImage--light_3UqQ navbar__logo"><img src="/OpenRace/img/coderrect-logo.png" alt="Coderrect OpenRace" class="themedImage_1VuW themedImage--dark_hz6m navbar__logo"><strong class="navbar__title">Coderrect OpenRace</strong></a></div><div class="navbar-sidebar__items"><div class="menu"><ul class="menu__list"><li class="menu__list-item"><a href="https://coderrect.com/blog/" target="_blank" rel="noopener noreferrer" class="menu__link">Blog</a></li><li class="menu__list-item"><a href="https://github.com/coderrect-inc/OpenRace" target="_blank" rel="noopener noreferrer" class="menu__link">GitHub</a></li></ul></div></div></div></nav><div class="main-wrapper docs-wrapper doc-page"><div class="docPage_31aa"><div class="docSidebarContainer_3Kbt" role="complementary"><div class="sidebar_15mo"><div class="menu menu--responsive thin-scrollbar menu_Bmed"><button aria-label="Open menu" aria-haspopup="true" class="button button--secondary button--sm menu__button" type="button"><svg aria-label="Menu" class="sidebarMenuIcon_fgN0" width="24" height="24" viewBox="0 0 30 30" role="img" focusable="false"><title>Menu</title><path stroke="currentColor" stroke-linecap="round" stroke-miterlimit="10" stroke-width="2" d="M4 7h22M4 15h22M4 23h22"></path></svg></button><ul class="menu__list"><li class="menu__list-item menu__list-item--collapsed"><a class="menu__link menu__link--sublist" href="#!">Quick Start</a><ul class="menu__list"><li class="menu__list-item"><a class="menu__link" tabindex="-1" href="/OpenRace/">Get Started with Coderrect OpenRace</a></li></ul></li><li class="menu__list-item"><a class="menu__link menu__link--sublist menu__link--active" href="#!">Developer Guide</a><ul class="menu__list"><li class="menu__list-item"><a class="menu__link" tabindex="0" href="/OpenRace/doc-setup-dev-env">Setting Up Dev Environment</a></li><li class="menu__list-item"><a aria-current="page" class="menu__link menu__link--active active" tabindex="0" href="/OpenRace/doc-overview">Design Overview</a></li><li class="menu__list-item"><a class="menu__link" tabindex="0" href="/OpenRace/doc-adding-new-features">Adding New Features</a></li><li class="menu__list-item"><a class="menu__link" tabindex="0" href="/OpenRace/doc-contribute-to-docs">Contribute to Docs</a></li><li class="menu__list-item"><a class="menu__link" tabindex="0" href="/OpenRace/doc-pta-arch">Pointer Analysis Architecture</a></li></ul></li></ul></div></div></div><main class="docMainContainer_3ufF"><div class="container padding-vert--lg docItemWrapper_3FMP"><div class="row"><div class="col docItemCol_3FnS"><div class="docItemContainer_33ec"><article><header><h1 class="docTitle_3a4h">Design Overview</h1></header><div class="markdown"><p>The description of this program is split into two parts.</p><p>The <a href="#flow-of-execution">Flow of Execution</a> describes how the input is processed step by step to produce an output, following the logical flow of the program.</p><p>The <a href="#project-layout">Project Layout</a> describes the project by its physical layout, through short summaries for each subdirectory in the <code>src</code> folder. </p><h2><a aria-hidden="true" tabindex="-1" class="anchor enhancedAnchor_2LWZ" id="flow-of-execution"></a>Flow of Execution<a class="hash-link" href="#flow-of-execution" title="Direct link to heading">#</a></h2><p>The logical entry point for the race detection functionality is in <code>src/RaceDetect/RaceDetect.h</code>. This function takes an LLVM IR module as input, and produces a race report as output.</p><p>The intermediate steps to produce the race report are:</p><ol><li>Construct a static program trace<ul><li>Preprocessing</li><li>Pointer Analysis</li><li>Race IR</li></ul></li><li>Run analyses</li><li>Combine analyses to do race detection</li><li>Generate report</li></ol><h3><a aria-hidden="true" tabindex="-1" class="anchor enhancedAnchor_2LWZ" id="program-trace"></a>Program Trace<a class="hash-link" href="#program-trace" title="Direct link to heading">#</a></h3><p>First a <code>ProgramTrace</code> is constructed from the input IR. This trace represents a simulated execution of the program.</p><p>During the construction of the program trace, a number of things happen.</p><ul><li><a href="#preprocessing">PreProcessing</a> transformations are run to make analyses easier</li><li>a whole program <a href="#pointeranalysis">PointerAnalysis</a> is run on the llvm module</li><li>the LLVM IR is converted to a higher level <a href="#ir">IR</a> for easier analysis</li></ul><p>See the <a href="#trace">Trace</a> section for more detail on how the <code>ProgramTrace</code> is built.</p><h3><a aria-hidden="true" tabindex="-1" class="anchor enhancedAnchor_2LWZ" id="analysis"></a>Analysis<a class="hash-link" href="#analysis" title="Direct link to heading">#</a></h3><p>Next a number of analyses are run. Each takes the program trace as input and can then be queried for some property in the program trace.</p><p>The core analyses are:</p><ul><li><strong>SharedMemory</strong> analysis finds events that could potentially access the same location in memory.</li><li><strong>HappensBefore</strong> analysis determines if two events could potentially happen in parallel.</li><li><strong>LockSet</strong> tracks what locks are held by an event during execution, and can be used to find if two events share a common lock.</li></ul><p>See the <a href="#analysis">Analysis</a> section for more details.</p><h3><a aria-hidden="true" tabindex="-1" class="anchor enhancedAnchor_2LWZ" id="race-detection"></a>Race Detection<a class="hash-link" href="#race-detection" title="Direct link to heading">#</a></h3><p> After constructing the program trace and analyses, the <code>detectRaces</code> function combines everything to detect any races.</p><p> A simple race detection algorithm could combine the core analyses like so:</p><div class="codeBlockContainer_K1bP"><div class="codeBlockContent_hGly cpp"><div tabindex="0" class="prism-code language-cpp codeBlock_23N8 thin-scrollbar"><div class="codeBlockLines_39YC" style="color:#bfc7d5;background-color:#292d3e"><div class="token-line" style="color:#bfc7d5"><span class="token plain">ProgramTrace program</span><span class="token punctuation" style="color:rgb(199, 146, 234)">;</span><span class="token plain"></span></div><div class="token-line" style="color:#bfc7d5"><span class="token plain" style="display:inline-block">
</span></div><div class="token-line" style="color:#bfc7d5"><span class="token plain">SharedMemory </span><span class="token function" style="color:rgb(130, 170, 255)">sharedmem</span><span class="token punctuation" style="color:rgb(199, 146, 234)">(</span><span class="token plain">program</span><span class="token punctuation" style="color:rgb(199, 146, 234)">)</span><span class="token punctuation" style="color:rgb(199, 146, 234)">;</span><span class="token plain"></span></div><div class="token-line" style="color:#bfc7d5"><span class="token plain">HappensBeforeGraph </span><span class="token function" style="color:rgb(130, 170, 255)">happensbefore</span><span class="token punctuation" style="color:rgb(199, 146, 234)">(</span><span class="token plain">program</span><span class="token punctuation" style="color:rgb(199, 146, 234)">)</span><span class="token punctuation" style="color:rgb(199, 146, 234)">;</span><span class="token plain"></span></div><div class="token-line" style="color:#bfc7d5"><span class="token plain">LockSet </span><span class="token function" style="color:rgb(130, 170, 255)">lockset</span><span class="token punctuation" style="color:rgb(199, 146, 234)">(</span><span class="token plain">program</span><span class="token punctuation" style="color:rgb(199, 146, 234)">)</span><span class="token punctuation" style="color:rgb(199, 146, 234)">;</span><span class="token plain"></span></div><div class="token-line" style="color:#bfc7d5"><span class="token plain" style="display:inline-block">
</span></div><div class="token-line" style="color:#bfc7d5"><span class="token plain"></span><span class="token keyword" style="font-style:italic">for</span><span class="token plain"> </span><span class="token punctuation" style="color:rgb(199, 146, 234)">(</span><span class="token keyword" style="font-style:italic">auto</span><span class="token plain"> sharedAccessPair </span><span class="token operator" style="color:rgb(137, 221, 255)">:</span><span class="token plain"> sharedmem</span><span class="token punctuation" style="color:rgb(199, 146, 234)">)</span><span class="token plain"> </span><span class="token punctuation" style="color:rgb(199, 146, 234)">{</span><span class="token plain"></span></div><div class="token-line" style="color:#bfc7d5"><span class="token plain">  </span><span class="token keyword" style="font-style:italic">if</span><span class="token plain"> </span><span class="token punctuation" style="color:rgb(199, 146, 234)">(</span><span class="token plain">happensbefore</span><span class="token punctuation" style="color:rgb(199, 146, 234)">.</span><span class="token function" style="color:rgb(130, 170, 255)">areParallel</span><span class="token punctuation" style="color:rgb(199, 146, 234)">(</span><span class="token plain">sharedAccessPair</span><span class="token punctuation" style="color:rgb(199, 146, 234)">)</span><span class="token plain"> </span></div><div class="token-line" style="color:#bfc7d5"><span class="token plain">    </span><span class="token operator" style="color:rgb(137, 221, 255)">&amp;&amp;</span><span class="token plain"> </span><span class="token operator" style="color:rgb(137, 221, 255)">!</span><span class="token plain">lockset</span><span class="token punctuation" style="color:rgb(199, 146, 234)">.</span><span class="token function" style="color:rgb(130, 170, 255)">shareLock</span><span class="token punctuation" style="color:rgb(199, 146, 234)">(</span><span class="token plain">sharedAccessPair</span><span class="token punctuation" style="color:rgb(199, 146, 234)">)</span><span class="token punctuation" style="color:rgb(199, 146, 234)">)</span><span class="token plain"> </span><span class="token punctuation" style="color:rgb(199, 146, 234)">{</span><span class="token plain"></span></div><div class="token-line" style="color:#bfc7d5"><span class="token plain">      </span><span class="token comment" style="color:rgb(105, 112, 152);font-style:italic">// report race!</span><span class="token plain"></span></div><div class="token-line" style="color:#bfc7d5"><span class="token plain">  </span><span class="token punctuation" style="color:rgb(199, 146, 234)">}</span><span class="token plain"></span></div><div class="token-line" style="color:#bfc7d5"><span class="token plain"></span><span class="token punctuation" style="color:rgb(199, 146, 234)">}</span></div></div></div><button type="button" aria-label="Copy code to clipboard" class="copyButton_Ue-o">Copy</button></div></div><p>See the <a href="#racedetect">RaceDetect</a> section.</p><h3><a aria-hidden="true" tabindex="-1" class="anchor enhancedAnchor_2LWZ" id="generate-report"></a>Generate Report<a class="hash-link" href="#generate-report" title="Direct link to heading">#</a></h3><p>Finally, a report needs to be generated so that any detected races can be displayed to the user or reported to some tool.</p><p>See the <a href="#reporter">Reporter</a> section.</p><h2><a aria-hidden="true" tabindex="-1" class="anchor enhancedAnchor_2LWZ" id="project-layout"></a>Project Layout<a class="hash-link" href="#project-layout" title="Direct link to heading">#</a></h2><p>This section describes code by each subdirectory in <code>src</code>. To get an idea of the flow of execution through the program, see the Logical Overview above.</p><p>The most important directories are:</p><ul><li><p><a href="#ir"><strong><code>IR</code></strong></a> for converting the input into a format we can analyze</p></li><li><p><a href="#pointeranalysis"><strong><code>PointerAnalysis</code></strong></a> for our custom pointer analysis implementation</p></li><li><p><a href="#languagemodel"><strong><code>LanguageModel</code></strong></a> for how language features are recognized</p></li><li><p><a href="#trace"><strong><code>Trace</code></strong></a> for generating a program Trace</p></li><li><p><a href="#analysis"><strong><code>Analysis</code></strong></a> for our different analyses</p><p>The top level <code>src</code> directory also contains the main race detection logic in <code>RaceDetect.h/cpp</code>, and <code>main.cpp</code> which is the entry point to the <code>racedetect</code> executable.</p></li></ul><h3><a aria-hidden="true" tabindex="-1" class="anchor enhancedAnchor_2LWZ" id="analysis-1"></a>Analysis<a class="hash-link" href="#analysis-1" title="Direct link to heading">#</a></h3><p>This directory contains all of our different analyses. Each of them takes a program trace as input and then allows for some specific property of the program trace to be queried.</p><p>Each of the analyses is constructed using the <code>ProgramTrace</code> to be analyzed, and then queried for specific data.</p><div class="codeBlockContainer_K1bP"><div class="codeBlockContent_hGly cpp"><div tabindex="0" class="prism-code language-cpp codeBlock_23N8 thin-scrollbar"><div class="codeBlockLines_39YC" style="color:#bfc7d5;background-color:#292d3e"><div class="token-line" style="color:#bfc7d5"><span class="token plain">ProgramTrace  program</span><span class="token punctuation" style="color:rgb(199, 146, 234)">;</span><span class="token plain"></span></div><div class="token-line" style="color:#bfc7d5"><span class="token plain"></span><span class="token punctuation" style="color:rgb(199, 146, 234)">.</span><span class="token punctuation" style="color:rgb(199, 146, 234)">.</span><span class="token punctuation" style="color:rgb(199, 146, 234)">.</span><span class="token plain"></span></div><div class="token-line" style="color:#bfc7d5"><span class="token plain"></span><span class="token comment" style="color:rgb(105, 112, 152);font-style:italic">// Construct from program trace</span><span class="token plain"></span></div><div class="token-line" style="color:#bfc7d5"><span class="token plain">HappensBeforeGraph </span><span class="token function" style="color:rgb(130, 170, 255)">hpg</span><span class="token punctuation" style="color:rgb(199, 146, 234)">(</span><span class="token plain">program</span><span class="token punctuation" style="color:rgb(199, 146, 234)">)</span><span class="token punctuation" style="color:rgb(199, 146, 234)">;</span><span class="token plain"></span></div><div class="token-line" style="color:#bfc7d5"><span class="token plain"></span><span class="token punctuation" style="color:rgb(199, 146, 234)">.</span><span class="token punctuation" style="color:rgb(199, 146, 234)">.</span><span class="token punctuation" style="color:rgb(199, 146, 234)">.</span><span class="token plain"></span></div><div class="token-line" style="color:#bfc7d5"><span class="token plain"></span><span class="token comment" style="color:rgb(105, 112, 152);font-style:italic">// Query to see if the events can be run in parallel</span><span class="token plain"></span></div><div class="token-line" style="color:#bfc7d5"><span class="token plain">hpg</span><span class="token punctuation" style="color:rgb(199, 146, 234)">.</span><span class="token function" style="color:rgb(130, 170, 255)">areParallel</span><span class="token punctuation" style="color:rgb(199, 146, 234)">(</span><span class="token plain">event1</span><span class="token punctuation" style="color:rgb(199, 146, 234)">,</span><span class="token plain"> event2</span><span class="token punctuation" style="color:rgb(199, 146, 234)">)</span><span class="token punctuation" style="color:rgb(199, 146, 234)">;</span></div></div></div><button type="button" aria-label="Copy code to clipboard" class="copyButton_Ue-o">Copy</button></div></div><h3><a aria-hidden="true" tabindex="-1" class="anchor enhancedAnchor_2LWZ" id="demangler"></a>Demangler<a class="hash-link" href="#demangler" title="Direct link to heading">#</a></h3><p>This directory contains some common code for demangling C++ function names.</p><h3><a aria-hidden="true" tabindex="-1" class="anchor enhancedAnchor_2LWZ" id="ir"></a>IR<a class="hash-link" href="#ir" title="Direct link to heading">#</a></h3><p>This folder contains interfaces describing logical operations (<code>IR.h</code>), implementations of those interfaces (<code>IRImpls.h</code>), and a function that takes an LLVM Function and constructs a list of logical operations (<code>Builder.h</code>).</p><p>In the context of race detection, most of the LLVM IR instructions are not needed.</p><p>Given an LLVM IR function that looks like this</p><div class="codeBlockContainer_K1bP"><div class="codeBlockContent_hGly"><div tabindex="0" class="prism-code language-undefined codeBlock_23N8 thin-scrollbar"><div class="codeBlockLines_39YC" style="color:#bfc7d5;background-color:#292d3e"><div class="token-line" style="color:#bfc7d5"><span class="token plain">%.global_tid..addr = alloca i32*</span></div><div class="token-line" style="color:#bfc7d5"><span class="token plain">%.bound_tid..addr = alloca i32*</span></div><div class="token-line" style="color:#bfc7d5"><span class="token plain">%count.addr = alloca i32*</span></div><div class="token-line" style="color:#bfc7d5"><span class="token plain">store i32* %.global_tid., i32** %.global_tid..addr</span></div><div class="token-line" style="color:#bfc7d5"><span class="token plain">call void @llvm.dbg.declare(metadata i32** %.global_tid..addr, metadata !23, metadata !DIExpression())</span></div><div class="token-line" style="color:#bfc7d5"><span class="token plain">store i32* %.bound_tid., i32** %.bound_tid..addr</span></div><div class="token-line" style="color:#bfc7d5"><span class="token plain">call void @llvm.dbg.declare(metadata i32** %.bound_tid..addr, metadata !25, metadata !DIExpression())</span></div><div class="token-line" style="color:#bfc7d5"><span class="token plain">store i32* %count, i32** %count.addr</span></div><div class="token-line" style="color:#bfc7d5"><span class="token plain">call void @llvm.dbg.declare(metadata i32** %count.addr, metadata !26, metadata !DIExpression())</span></div><div class="token-line" style="color:#bfc7d5"><span class="token plain">%0 = load i32*, i32** %count.addr</span></div><div class="token-line" style="color:#bfc7d5"><span class="token plain">%1 = load i32, i32* %0, align 4</span></div><div class="token-line" style="color:#bfc7d5"><span class="token plain">%inc = add nsw i32 %1, 1</span></div><div class="token-line" style="color:#bfc7d5"><span class="token plain">store i32 %inc, i32* %0, align 4</span></div><div class="token-line" style="color:#bfc7d5"><span class="token plain">ret void</span></div></div></div><button type="button" aria-label="Copy code to clipboard" class="copyButton_Ue-o">Copy</button></div></div><p>Race detection only really needs to know the following</p><div class="codeBlockContainer_K1bP"><div class="codeBlockContent_hGly"><div tabindex="0" class="prism-code language-undefined codeBlock_23N8 thin-scrollbar"><div class="codeBlockLines_39YC" style="color:#bfc7d5;background-color:#292d3e"><div class="token-line" style="color:#bfc7d5"><span class="token plain">write i32** %.global_tid..addr</span></div><div class="token-line" style="color:#bfc7d5"><span class="token plain">write i32** %.bound_tid..addr</span></div><div class="token-line" style="color:#bfc7d5"><span class="token plain">write i32** %count.addr</span></div><div class="token-line" style="color:#bfc7d5"><span class="token plain">read i32** %count.addr</span></div><div class="token-line" style="color:#bfc7d5"><span class="token plain">read %0</span></div><div class="token-line" style="color:#bfc7d5"><span class="token plain">write %0</span></div></div></div><button type="button" aria-label="Copy code to clipboard" class="copyButton_Ue-o">Copy</button></div></div><p>So the code in the IR directory focuses on extracting only the LLVM instructions needed for race detection, and wrapping them in a common set of interfaces (read, write, fork, join) that can be consumed more easily by later analyses.</p><p>The logical operation interfaces are wrappers around LLVM Instructions, and return values in terms of LLVM IR. Logical operations will later be converted to program events, which answer questions in terms of static program execution.</p><p>As an example, in the context of race detection the only information we really need to know about a read operation, is what value is being read.</p><p>So, the interface for a logical read operation looks something like the following.</p><div class="codeBlockContainer_K1bP"><div class="codeBlockContent_hGly cpp"><div tabindex="0" class="prism-code language-cpp codeBlock_23N8 thin-scrollbar"><div class="codeBlockLines_39YC" style="color:#bfc7d5;background-color:#292d3e"><div class="token-line" style="color:#bfc7d5"><span class="token keyword" style="font-style:italic">class</span><span class="token plain"> </span><span class="token class-name" style="color:rgb(255, 203, 107)">Read</span><span class="token plain"> </span><span class="token punctuation" style="color:rgb(199, 146, 234)">{</span><span class="token plain"></span></div><div class="token-line" style="color:#bfc7d5"><span class="token plain"></span><span class="token keyword" style="font-style:italic">public</span><span class="token operator" style="color:rgb(137, 221, 255)">:</span><span class="token plain"></span></div><div class="token-line" style="color:#bfc7d5"><span class="token plain">    </span><span class="token keyword" style="font-style:italic">virtual</span><span class="token plain"> </span><span class="token keyword" style="font-style:italic">const</span><span class="token plain"> llvm</span><span class="token operator" style="color:rgb(137, 221, 255)">::</span><span class="token plain">Inst</span><span class="token operator" style="color:rgb(137, 221, 255)">*</span><span class="token plain"> </span><span class="token function" style="color:rgb(130, 170, 255)">getInst</span><span class="token punctuation" style="color:rgb(199, 146, 234)">(</span><span class="token punctuation" style="color:rgb(199, 146, 234)">)</span><span class="token plain"> </span><span class="token keyword" style="font-style:italic">const</span><span class="token plain"> </span><span class="token operator" style="color:rgb(137, 221, 255)">=</span><span class="token plain">  </span><span class="token number" style="color:rgb(247, 140, 108)">0</span><span class="token punctuation" style="color:rgb(199, 146, 234)">;</span><span class="token plain"></span></div><div class="token-line" style="color:#bfc7d5"><span class="token plain">    </span><span class="token keyword" style="font-style:italic">virtual</span><span class="token plain"> </span><span class="token keyword" style="font-style:italic">const</span><span class="token plain"> llvm</span><span class="token operator" style="color:rgb(137, 221, 255)">::</span><span class="token plain">Value </span><span class="token operator" style="color:rgb(137, 221, 255)">*</span><span class="token function" style="color:rgb(130, 170, 255)">getReadValue</span><span class="token punctuation" style="color:rgb(199, 146, 234)">(</span><span class="token punctuation" style="color:rgb(199, 146, 234)">)</span><span class="token plain"> </span><span class="token keyword" style="font-style:italic">const</span><span class="token plain"> </span><span class="token operator" style="color:rgb(137, 221, 255)">=</span><span class="token plain"> </span><span class="token number" style="color:rgb(247, 140, 108)">0</span><span class="token punctuation" style="color:rgb(199, 146, 234)">;</span><span class="token plain"></span></div><div class="token-line" style="color:#bfc7d5"><span class="token plain"></span><span class="token punctuation" style="color:rgb(199, 146, 234)">}</span><span class="token punctuation" style="color:rgb(199, 146, 234)">;</span></div></div></div><button type="button" aria-label="Copy code to clipboard" class="copyButton_Ue-o">Copy</button></div></div><p>Many instructions can act as logical reads. A vector access, some external functions call, or just the LLVM IR load instruction.</p><p>Now to treat different types of llvm instructions as reads, we just need to define a derived class implementing the read interface.</p><div class="codeBlockContainer_K1bP"><div class="codeBlockContent_hGly cpp"><div tabindex="0" class="prism-code language-cpp codeBlock_23N8 thin-scrollbar"><div class="codeBlockLines_39YC" style="color:#bfc7d5;background-color:#292d3e"><div class="token-line" style="color:#bfc7d5"><span class="token keyword" style="font-style:italic">class</span><span class="token plain"> </span><span class="token class-name" style="color:rgb(255, 203, 107)">Load</span><span class="token plain"> </span><span class="token operator" style="color:rgb(137, 221, 255)">:</span><span class="token plain"> </span><span class="token base-clause class-name" style="color:rgb(255, 203, 107)">public</span><span class="token base-clause"> </span><span class="token base-clause class-name" style="color:rgb(255, 203, 107)">Read</span><span class="token plain"> </span><span class="token punctuation" style="color:rgb(199, 146, 234)">{</span><span class="token plain"></span></div><div class="token-line" style="color:#bfc7d5"><span class="token plain">    </span><span class="token keyword" style="font-style:italic">const</span><span class="token plain"> LoadInst </span><span class="token operator" style="color:rgb(137, 221, 255)">*</span><span class="token plain">load</span><span class="token punctuation" style="color:rgb(199, 146, 234)">;</span><span class="token plain"></span></div><div class="token-line" style="color:#bfc7d5"><span class="token plain"></span><span class="token keyword" style="font-style:italic">public</span><span class="token operator" style="color:rgb(137, 221, 255)">:</span><span class="token plain"></span></div><div class="token-line" style="color:#bfc7d5"><span class="token plain">    </span><span class="token keyword" style="font-style:italic">const</span><span class="token plain"> llvm</span><span class="token operator" style="color:rgb(137, 221, 255)">::</span><span class="token plain">LoadInst</span><span class="token operator" style="color:rgb(137, 221, 255)">*</span><span class="token plain"> </span><span class="token function" style="color:rgb(130, 170, 255)">getInst</span><span class="token punctuation" style="color:rgb(199, 146, 234)">(</span><span class="token punctuation" style="color:rgb(199, 146, 234)">)</span><span class="token plain"> </span><span class="token keyword" style="font-style:italic">const</span><span class="token plain"> override </span><span class="token punctuation" style="color:rgb(199, 146, 234)">{</span><span class="token plain"> </span><span class="token keyword" style="font-style:italic">return</span><span class="token plain"> load</span><span class="token punctuation" style="color:rgb(199, 146, 234)">;</span><span class="token plain"> </span><span class="token punctuation" style="color:rgb(199, 146, 234)">}</span><span class="token plain"></span></div><div class="token-line" style="color:#bfc7d5"><span class="token plain">    </span><span class="token keyword" style="font-style:italic">const</span><span class="token plain"> llvm</span><span class="token operator" style="color:rgb(137, 221, 255)">::</span><span class="token plain">Value </span><span class="token operator" style="color:rgb(137, 221, 255)">*</span><span class="token function" style="color:rgb(130, 170, 255)">getReadValue</span><span class="token punctuation" style="color:rgb(199, 146, 234)">(</span><span class="token punctuation" style="color:rgb(199, 146, 234)">)</span><span class="token plain"> </span><span class="token keyword" style="font-style:italic">const</span><span class="token plain"> override </span><span class="token punctuation" style="color:rgb(199, 146, 234)">{</span><span class="token plain"> </span><span class="token keyword" style="font-style:italic">return</span><span class="token plain"> load</span><span class="token operator" style="color:rgb(137, 221, 255)">-&gt;</span><span class="token function" style="color:rgb(130, 170, 255)">getPointerOperand</span><span class="token punctuation" style="color:rgb(199, 146, 234)">(</span><span class="token punctuation" style="color:rgb(199, 146, 234)">)</span><span class="token punctuation" style="color:rgb(199, 146, 234)">;</span><span class="token plain"> </span><span class="token punctuation" style="color:rgb(199, 146, 234)">}</span><span class="token plain"></span></div><div class="token-line" style="color:#bfc7d5"><span class="token plain"></span><span class="token punctuation" style="color:rgb(199, 146, 234)">}</span><span class="token punctuation" style="color:rgb(199, 146, 234)">;</span><span class="token plain"></span></div><div class="token-line" style="color:#bfc7d5"><span class="token plain" style="display:inline-block">
</span></div><div class="token-line" style="color:#bfc7d5"><span class="token plain"></span><span class="token keyword" style="font-style:italic">class</span><span class="token plain"> </span><span class="token class-name" style="color:rgb(255, 203, 107)">MemCpyRead</span><span class="token plain"> </span><span class="token operator" style="color:rgb(137, 221, 255)">:</span><span class="token plain"> </span><span class="token base-clause class-name" style="color:rgb(255, 203, 107)">public</span><span class="token base-clause"> </span><span class="token base-clause class-name" style="color:rgb(255, 203, 107)">Read</span><span class="token plain"> </span><span class="token punctuation" style="color:rgb(199, 146, 234)">{</span><span class="token plain"></span></div><div class="token-line" style="color:#bfc7d5"><span class="token plain">    </span><span class="token keyword" style="font-style:italic">const</span><span class="token plain"> CallBase </span><span class="token operator" style="color:rgb(137, 221, 255)">*</span><span class="token plain">inst</span><span class="token punctuation" style="color:rgb(199, 146, 234)">;</span><span class="token plain"></span></div><div class="token-line" style="color:#bfc7d5"><span class="token plain"></span><span class="token keyword" style="font-style:italic">public</span><span class="token operator" style="color:rgb(137, 221, 255)">:</span><span class="token plain"></span></div><div class="token-line" style="color:#bfc7d5"><span class="token plain">    </span><span class="token keyword" style="font-style:italic">const</span><span class="token plain"> llvm</span><span class="token operator" style="color:rgb(137, 221, 255)">::</span><span class="token plain">LoaCallBasedInst</span><span class="token operator" style="color:rgb(137, 221, 255)">*</span><span class="token plain"> </span><span class="token function" style="color:rgb(130, 170, 255)">getInst</span><span class="token punctuation" style="color:rgb(199, 146, 234)">(</span><span class="token punctuation" style="color:rgb(199, 146, 234)">)</span><span class="token plain"> </span><span class="token keyword" style="font-style:italic">const</span><span class="token plain"> override </span><span class="token punctuation" style="color:rgb(199, 146, 234)">{</span><span class="token plain"> </span><span class="token keyword" style="font-style:italic">return</span><span class="token plain"> inst</span><span class="token punctuation" style="color:rgb(199, 146, 234)">;</span><span class="token plain"> </span><span class="token punctuation" style="color:rgb(199, 146, 234)">}</span><span class="token plain"></span></div><div class="token-line" style="color:#bfc7d5"><span class="token plain" style="display:inline-block">
</span></div><div class="token-line" style="color:#bfc7d5"><span class="token plain">    </span><span class="token comment" style="color:rgb(105, 112, 152);font-style:italic">// Assuming 3rd operand is the value being read. This is a fake example</span><span class="token plain"></span></div><div class="token-line" style="color:#bfc7d5"><span class="token plain">    </span><span class="token keyword" style="font-style:italic">const</span><span class="token plain"> llvm</span><span class="token operator" style="color:rgb(137, 221, 255)">::</span><span class="token plain">Value </span><span class="token operator" style="color:rgb(137, 221, 255)">*</span><span class="token function" style="color:rgb(130, 170, 255)">getReadValue</span><span class="token punctuation" style="color:rgb(199, 146, 234)">(</span><span class="token punctuation" style="color:rgb(199, 146, 234)">)</span><span class="token plain"> </span><span class="token keyword" style="font-style:italic">const</span><span class="token plain"> override </span><span class="token punctuation" style="color:rgb(199, 146, 234)">{</span><span class="token plain"> </span><span class="token keyword" style="font-style:italic">return</span><span class="token plain"> load</span><span class="token operator" style="color:rgb(137, 221, 255)">-&gt;</span><span class="token function" style="color:rgb(130, 170, 255)">getOperand</span><span class="token punctuation" style="color:rgb(199, 146, 234)">(</span><span class="token number" style="color:rgb(247, 140, 108)">3</span><span class="token punctuation" style="color:rgb(199, 146, 234)">)</span><span class="token punctuation" style="color:rgb(199, 146, 234)">;</span><span class="token plain"> </span><span class="token punctuation" style="color:rgb(199, 146, 234)">}</span><span class="token plain"></span></div><div class="token-line" style="color:#bfc7d5"><span class="token plain"></span><span class="token punctuation" style="color:rgb(199, 146, 234)">}</span><span class="token punctuation" style="color:rgb(199, 146, 234)">;</span></div></div></div><button type="button" aria-label="Copy code to clipboard" class="copyButton_Ue-o">Copy</button></div></div><p>Lastly, the Builder file contains functions to recognize and construct these concrete implementations from LLVM IR.</p><p>There is a loop that looks something like</p><div class="codeBlockContainer_K1bP"><div class="codeBlockContent_hGly cpp"><div tabindex="0" class="prism-code language-cpp codeBlock_23N8 thin-scrollbar"><div class="codeBlockLines_39YC" style="color:#bfc7d5;background-color:#292d3e"><div class="token-line" style="color:#bfc7d5"><span class="token comment" style="color:rgb(105, 112, 152);font-style:italic">// Note: not real code</span><span class="token plain"></span></div><div class="token-line" style="color:#bfc7d5"><span class="token plain">llvm</span><span class="token operator" style="color:rgb(137, 221, 255)">::</span><span class="token plain">Function input</span><span class="token punctuation" style="color:rgb(199, 146, 234)">;</span><span class="token plain"></span></div><div class="token-line" style="color:#bfc7d5"><span class="token plain">LogicalOperations output</span><span class="token punctuation" style="color:rgb(199, 146, 234)">;</span><span class="token plain"></span></div><div class="token-line" style="color:#bfc7d5"><span class="token plain" style="display:inline-block">
</span></div><div class="token-line" style="color:#bfc7d5"><span class="token plain"></span><span class="token keyword" style="font-style:italic">for</span><span class="token plain"> </span><span class="token punctuation" style="color:rgb(199, 146, 234)">(</span><span class="token keyword" style="font-style:italic">auto</span><span class="token plain"> instruction </span><span class="token operator" style="color:rgb(137, 221, 255)">:</span><span class="token plain"> input</span><span class="token punctuation" style="color:rgb(199, 146, 234)">.</span><span class="token function" style="color:rgb(130, 170, 255)">instruction</span><span class="token punctuation" style="color:rgb(199, 146, 234)">(</span><span class="token punctuation" style="color:rgb(199, 146, 234)">)</span><span class="token punctuation" style="color:rgb(199, 146, 234)">)</span><span class="token plain"> </span><span class="token punctuation" style="color:rgb(199, 146, 234)">{</span><span class="token plain"></span></div><div class="token-line" style="color:#bfc7d5"><span class="token plain">   </span><span class="token keyword" style="font-style:italic">if</span><span class="token plain"> </span><span class="token punctuation" style="color:rgb(199, 146, 234)">(</span><span class="token function" style="color:rgb(130, 170, 255)">isLoad</span><span class="token punctuation" style="color:rgb(199, 146, 234)">(</span><span class="token plain">instruction</span><span class="token punctuation" style="color:rgb(199, 146, 234)">)</span><span class="token punctuation" style="color:rgb(199, 146, 234)">)</span><span class="token plain"> </span><span class="token punctuation" style="color:rgb(199, 146, 234)">{</span><span class="token plain"></span></div><div class="token-line" style="color:#bfc7d5"><span class="token plain">       </span><span class="token keyword" style="font-style:italic">auto</span><span class="token plain"> read </span><span class="token operator" style="color:rgb(137, 221, 255)">=</span><span class="token plain"> </span><span class="token function" style="color:rgb(130, 170, 255)">Load</span><span class="token punctuation" style="color:rgb(199, 146, 234)">(</span><span class="token plain">instruction</span><span class="token punctuation" style="color:rgb(199, 146, 234)">)</span><span class="token punctuation" style="color:rgb(199, 146, 234)">;</span><span class="token plain"></span></div><div class="token-line" style="color:#bfc7d5"><span class="token plain">       output</span><span class="token punctuation" style="color:rgb(199, 146, 234)">.</span><span class="token function" style="color:rgb(130, 170, 255)">push_back</span><span class="token punctuation" style="color:rgb(199, 146, 234)">(</span><span class="token plain">read</span><span class="token punctuation" style="color:rgb(199, 146, 234)">)</span><span class="token plain"></span></div><div class="token-line" style="color:#bfc7d5"><span class="token plain">   </span><span class="token punctuation" style="color:rgb(199, 146, 234)">}</span><span class="token plain"></span></div><div class="token-line" style="color:#bfc7d5"><span class="token plain">   </span><span class="token keyword" style="font-style:italic">else</span><span class="token plain"> </span><span class="token keyword" style="font-style:italic">if</span><span class="token plain"> </span><span class="token punctuation" style="color:rgb(199, 146, 234)">(</span><span class="token function" style="color:rgb(130, 170, 255)">isMemCpy</span><span class="token punctuation" style="color:rgb(199, 146, 234)">(</span><span class="token plain">instruction</span><span class="token punctuation" style="color:rgb(199, 146, 234)">)</span><span class="token punctuation" style="color:rgb(199, 146, 234)">)</span><span class="token plain"> </span><span class="token punctuation" style="color:rgb(199, 146, 234)">{</span><span class="token plain"></span></div><div class="token-line" style="color:#bfc7d5"><span class="token plain">       </span><span class="token keyword" style="font-style:italic">auto</span><span class="token plain"> read </span><span class="token operator" style="color:rgb(137, 221, 255)">=</span><span class="token plain"> </span><span class="token function" style="color:rgb(130, 170, 255)">MemCpyRead</span><span class="token punctuation" style="color:rgb(199, 146, 234)">(</span><span class="token plain">instruction</span><span class="token punctuation" style="color:rgb(199, 146, 234)">)</span><span class="token punctuation" style="color:rgb(199, 146, 234)">;</span><span class="token plain"></span></div><div class="token-line" style="color:#bfc7d5"><span class="token plain">       output</span><span class="token punctuation" style="color:rgb(199, 146, 234)">.</span><span class="token function" style="color:rgb(130, 170, 255)">push_back</span><span class="token punctuation" style="color:rgb(199, 146, 234)">(</span><span class="token plain">read</span><span class="token punctuation" style="color:rgb(199, 146, 234)">)</span><span class="token plain"></span></div><div class="token-line" style="color:#bfc7d5"><span class="token plain">   </span><span class="token punctuation" style="color:rgb(199, 146, 234)">}</span><span class="token plain"></span></div><div class="token-line" style="color:#bfc7d5"><span class="token plain">   </span><span class="token punctuation" style="color:rgb(199, 146, 234)">.</span><span class="token punctuation" style="color:rgb(199, 146, 234)">.</span><span class="token punctuation" style="color:rgb(199, 146, 234)">.</span><span class="token plain"></span></div><div class="token-line" style="color:#bfc7d5"><span class="token plain"></span><span class="token punctuation" style="color:rgb(199, 146, 234)">}</span></div></div></div><button type="button" aria-label="Copy code to clipboard" class="copyButton_Ue-o">Copy</button></div></div><p>Each branch in the loop call a &quot;recognizer&quot; function defined in the <code>LanguageModel</code> directory.</p><p>When a match is found, the corresponding concrete impl is constructed and added to the list of logical operations.</p><h3><a aria-hidden="true" tabindex="-1" class="anchor enhancedAnchor_2LWZ" id="languagemodel"></a>LanguageModel<a class="hash-link" href="#languagemodel" title="Direct link to heading">#</a></h3><p>The LanguageModel directory contains code related to recognizing certain language or framework features in LLVM IR.</p><p>Most of the files in this directory recognize specific API calls. For example, pthread.h contains a list of &quot;recognizers&quot;.</p><div class="codeBlockContainer_K1bP"><div class="codeBlockContent_hGly cpp"><div tabindex="0" class="prism-code language-cpp codeBlock_23N8 thin-scrollbar"><div class="codeBlockLines_39YC" style="color:#bfc7d5;background-color:#292d3e"><div class="token-line" style="color:#bfc7d5"><span class="token comment" style="color:rgb(105, 112, 152);font-style:italic">// pthread.h</span><span class="token plain"></span></div><div class="token-line" style="color:#bfc7d5"><span class="token plain"></span><span class="token punctuation" style="color:rgb(199, 146, 234)">.</span><span class="token punctuation" style="color:rgb(199, 146, 234)">.</span><span class="token punctuation" style="color:rgb(199, 146, 234)">.</span><span class="token plain"></span></div><div class="token-line" style="color:#bfc7d5"><span class="token plain"></span><span class="token keyword" style="font-style:italic">bool</span><span class="token plain"> </span><span class="token function" style="color:rgb(130, 170, 255)">isPthreadCreate</span><span class="token punctuation" style="color:rgb(199, 146, 234)">(</span><span class="token plain">llvm</span><span class="token operator" style="color:rgb(137, 221, 255)">::</span><span class="token plain">StringRef name</span><span class="token punctuation" style="color:rgb(199, 146, 234)">)</span><span class="token punctuation" style="color:rgb(199, 146, 234)">;</span><span class="token plain"></span></div><div class="token-line" style="color:#bfc7d5"><span class="token plain"></span><span class="token keyword" style="font-style:italic">bool</span><span class="token plain"> </span><span class="token function" style="color:rgb(130, 170, 255)">isPthreadJoin</span><span class="token punctuation" style="color:rgb(199, 146, 234)">(</span><span class="token plain">llvm</span><span class="token operator" style="color:rgb(137, 221, 255)">::</span><span class="token plain">StringRef name</span><span class="token punctuation" style="color:rgb(199, 146, 234)">)</span><span class="token punctuation" style="color:rgb(199, 146, 234)">;</span><span class="token plain"></span></div><div class="token-line" style="color:#bfc7d5"><span class="token plain"></span><span class="token punctuation" style="color:rgb(199, 146, 234)">.</span><span class="token punctuation" style="color:rgb(199, 146, 234)">.</span><span class="token punctuation" style="color:rgb(199, 146, 234)">.</span></div></div></div><button type="button" aria-label="Copy code to clipboard" class="copyButton_Ue-o">Copy</button></div></div><p>These recognizers are used to determine if the function being called is a certain API call (e..g. pthread create or join). The majority of the code in LanguageModel are recognizers like this for various libraries or frameworks.</p><p>The only exceptions are the <code>RaceModel.*</code> files.</p><h4><a aria-hidden="true" tabindex="-1" class="anchor enhancedAnchor_2LWZ" id="racemodel"></a>RaceModel<a class="hash-link" href="#racemodel" title="Direct link to heading">#</a></h4><p>RaceModel tells PointerAnalysis how to interpret certain function calls.</p><p>Given this example</p><div class="codeBlockContainer_K1bP"><div class="codeBlockContent_hGly cpp"><div tabindex="0" class="prism-code language-cpp codeBlock_23N8 thin-scrollbar"><div class="codeBlockLines_39YC" style="color:#bfc7d5;background-color:#292d3e"><div class="token-line" style="color:#bfc7d5"><span class="token keyword" style="font-style:italic">void</span><span class="token plain"> </span><span class="token operator" style="color:rgb(137, 221, 255)">*</span><span class="token function" style="color:rgb(130, 170, 255)">entry</span><span class="token punctuation" style="color:rgb(199, 146, 234)">(</span><span class="token keyword" style="font-style:italic">void</span><span class="token plain"> </span><span class="token operator" style="color:rgb(137, 221, 255)">*</span><span class="token plain">arg</span><span class="token punctuation" style="color:rgb(199, 146, 234)">)</span><span class="token plain"> </span><span class="token punctuation" style="color:rgb(199, 146, 234)">{</span><span class="token punctuation" style="color:rgb(199, 146, 234)">.</span><span class="token punctuation" style="color:rgb(199, 146, 234)">.</span><span class="token punctuation" style="color:rgb(199, 146, 234)">.</span><span class="token punctuation" style="color:rgb(199, 146, 234)">}</span><span class="token plain"></span></div><div class="token-line" style="color:#bfc7d5"><span class="token plain"></span><span class="token punctuation" style="color:rgb(199, 146, 234)">.</span><span class="token punctuation" style="color:rgb(199, 146, 234)">.</span><span class="token punctuation" style="color:rgb(199, 146, 234)">.</span><span class="token plain"></span></div><div class="token-line" style="color:#bfc7d5"><span class="token plain"></span><span class="token function" style="color:rgb(130, 170, 255)">pthread_create</span><span class="token punctuation" style="color:rgb(199, 146, 234)">(</span><span class="token plain">t</span><span class="token punctuation" style="color:rgb(199, 146, 234)">,</span><span class="token plain"> </span><span class="token constant" style="color:rgb(130, 170, 255)">NULL</span><span class="token punctuation" style="color:rgb(199, 146, 234)">,</span><span class="token plain"> entry</span><span class="token punctuation" style="color:rgb(199, 146, 234)">,</span><span class="token plain"> </span><span class="token operator" style="color:rgb(137, 221, 255)">&amp;</span><span class="token plain">val</span><span class="token punctuation" style="color:rgb(199, 146, 234)">)</span><span class="token punctuation" style="color:rgb(199, 146, 234)">;</span></div></div></div><button type="button" aria-label="Copy code to clipboard" class="copyButton_Ue-o">Copy</button></div></div><p>Pointer analysis needs to know that the call to pthread_create will cause the <code>entry</code> function to be executed, and that the <code>arg</code> passed to the entry function points to the memory location of <code>val</code>.</p><p>The RaceModel class is used to extend PointerAnalysis with the information necessary to build a correct call graph and link function arguments.</p><p>The two functions that control this are:</p><ul><li><strong><code>interceptFunction</code></strong> which decides how each function is expanded in the call graph</li><li><strong><code>interceptCallSite</code></strong> which links the pointer from the call site to the called function</li></ul><p>As any example, to tell Pointer Analysis that a call to <code>pthread_create(t, NULL, entry, &amp;val)</code> should result in the <code>entry</code> function being visited next in the call graph, <code>interceptFunction</code> can be modified to include the following code.</p><div class="codeBlockContainer_K1bP"><div class="codeBlockContent_hGly cpp"><div tabindex="0" class="prism-code language-cpp codeBlock_23N8 thin-scrollbar"><div class="codeBlockLines_39YC" style="color:#bfc7d5;background-color:#292d3e"><div class="token-line" style="color:#bfc7d5"><span class="token plain">InterceptResult </span><span class="token class-name" style="color:rgb(255, 203, 107)">RaceModel</span><span class="token operator" style="color:rgb(137, 221, 255)">::</span><span class="token function" style="color:rgb(130, 170, 255)">interceptFunction</span><span class="token punctuation" style="color:rgb(199, 146, 234)">(</span><span class="token keyword" style="font-style:italic">const</span><span class="token plain"> ctx </span><span class="token operator" style="color:rgb(137, 221, 255)">*</span><span class="token plain">callerCtx</span><span class="token punctuation" style="color:rgb(199, 146, 234)">,</span><span class="token plain"> </span><span class="token keyword" style="font-style:italic">const</span><span class="token plain"> ctx </span><span class="token operator" style="color:rgb(137, 221, 255)">*</span><span class="token plain">calleeCtx</span><span class="token punctuation" style="color:rgb(199, 146, 234)">,</span><span class="token plain"> </span><span class="token keyword" style="font-style:italic">const</span><span class="token plain"> llvm</span><span class="token operator" style="color:rgb(137, 221, 255)">::</span><span class="token plain">Function </span><span class="token operator" style="color:rgb(137, 221, 255)">*</span><span class="token plain">F</span><span class="token punctuation" style="color:rgb(199, 146, 234)">,</span><span class="token plain"> </span><span class="token keyword" style="font-style:italic">const</span><span class="token plain"> llvm</span><span class="token operator" style="color:rgb(137, 221, 255)">::</span><span class="token plain">Instruction </span><span class="token operator" style="color:rgb(137, 221, 255)">*</span><span class="token plain">callsite</span><span class="token punctuation" style="color:rgb(199, 146, 234)">)</span><span class="token plain"> </span><span class="token punctuation" style="color:rgb(199, 146, 234)">{</span><span class="token plain"></span></div><div class="token-line" style="color:#bfc7d5"><span class="token plain">  </span><span class="token keyword" style="font-style:italic">auto</span><span class="token plain"> funcName </span><span class="token operator" style="color:rgb(137, 221, 255)">=</span><span class="token plain"> F</span><span class="token operator" style="color:rgb(137, 221, 255)">-&gt;</span><span class="token function" style="color:rgb(130, 170, 255)">getName</span><span class="token punctuation" style="color:rgb(199, 146, 234)">(</span><span class="token punctuation" style="color:rgb(199, 146, 234)">)</span><span class="token punctuation" style="color:rgb(199, 146, 234)">;</span><span class="token plain"></span></div><div class="token-line" style="color:#bfc7d5"><span class="token plain">  </span><span class="token punctuation" style="color:rgb(199, 146, 234)">.</span><span class="token punctuation" style="color:rgb(199, 146, 234)">.</span><span class="token punctuation" style="color:rgb(199, 146, 234)">.</span><span class="token plain"></span></div><div class="token-line" style="color:#bfc7d5"><span class="token plain">  </span><span class="token keyword" style="font-style:italic">if</span><span class="token plain"> </span><span class="token punctuation" style="color:rgb(199, 146, 234)">(</span><span class="token class-name" style="color:rgb(255, 203, 107)">PthreadModel</span><span class="token operator" style="color:rgb(137, 221, 255)">::</span><span class="token function" style="color:rgb(130, 170, 255)">isPthreadCreate</span><span class="token punctuation" style="color:rgb(199, 146, 234)">(</span><span class="token plain">funcName</span><span class="token punctuation" style="color:rgb(199, 146, 234)">)</span><span class="token punctuation" style="color:rgb(199, 146, 234)">)</span><span class="token plain"> </span><span class="token punctuation" style="color:rgb(199, 146, 234)">{</span><span class="token plain"></span></div><div class="token-line" style="color:#bfc7d5"><span class="token plain">    race</span><span class="token operator" style="color:rgb(137, 221, 255)">::</span><span class="token plain">PthreadCreateIR </span><span class="token function" style="color:rgb(130, 170, 255)">create</span><span class="token punctuation" style="color:rgb(199, 146, 234)">(</span><span class="token plain">llvm</span><span class="token operator" style="color:rgb(137, 221, 255)">::</span><span class="token plain">cast</span><span class="token operator" style="color:rgb(137, 221, 255)">&lt;</span><span class="token plain">CallBase</span><span class="token operator" style="color:rgb(137, 221, 255)">&gt;</span><span class="token punctuation" style="color:rgb(199, 146, 234)">(</span><span class="token plain">callsite</span><span class="token punctuation" style="color:rgb(199, 146, 234)">)</span><span class="token punctuation" style="color:rgb(199, 146, 234)">)</span><span class="token punctuation" style="color:rgb(199, 146, 234)">;</span><span class="token plain"></span></div><div class="token-line" style="color:#bfc7d5"><span class="token plain">    </span><span class="token keyword" style="font-style:italic">auto</span><span class="token plain"> callback </span><span class="token operator" style="color:rgb(137, 221, 255)">=</span><span class="token plain"> create</span><span class="token punctuation" style="color:rgb(199, 146, 234)">.</span><span class="token function" style="color:rgb(130, 170, 255)">getThreadEntry</span><span class="token punctuation" style="color:rgb(199, 146, 234)">(</span><span class="token punctuation" style="color:rgb(199, 146, 234)">)</span><span class="token operator" style="color:rgb(137, 221, 255)">-&gt;</span><span class="token function" style="color:rgb(130, 170, 255)">stripPointerCasts</span><span class="token punctuation" style="color:rgb(199, 146, 234)">(</span><span class="token punctuation" style="color:rgb(199, 146, 234)">)</span><span class="token punctuation" style="color:rgb(199, 146, 234)">;</span><span class="token plain"></span></div><div class="token-line" style="color:#bfc7d5"><span class="token plain">    </span><span class="token keyword" style="font-style:italic">return</span><span class="token plain"> </span><span class="token punctuation" style="color:rgb(199, 146, 234)">{</span><span class="token plain">callback</span><span class="token punctuation" style="color:rgb(199, 146, 234)">,</span><span class="token plain"> InterceptResult</span><span class="token operator" style="color:rgb(137, 221, 255)">::</span><span class="token plain">Option</span><span class="token operator" style="color:rgb(137, 221, 255)">::</span><span class="token plain">EXPAND_BODY</span><span class="token punctuation" style="color:rgb(199, 146, 234)">}</span><span class="token punctuation" style="color:rgb(199, 146, 234)">;</span><span class="token plain"></span></div><div class="token-line" style="color:#bfc7d5"><span class="token plain">  </span><span class="token punctuation" style="color:rgb(199, 146, 234)">}</span><span class="token plain"></span></div><div class="token-line" style="color:#bfc7d5"><span class="token plain">  </span><span class="token punctuation" style="color:rgb(199, 146, 234)">.</span><span class="token punctuation" style="color:rgb(199, 146, 234)">.</span><span class="token punctuation" style="color:rgb(199, 146, 234)">.</span></div></div></div><button type="button" aria-label="Copy code to clipboard" class="copyButton_Ue-o">Copy</button></div></div><p>To also link the pointer passed to the entry function (e.g. link<code>&amp;val</code> to <code>void *arg</code>), the <code>interceptCallSite</code> can be updated accordingly.</p><div class="codeBlockContainer_K1bP"><div class="codeBlockContent_hGly cpp"><div tabindex="0" class="prism-code language-cpp codeBlock_23N8 thin-scrollbar"><div class="codeBlockLines_39YC" style="color:#bfc7d5;background-color:#292d3e"><div class="token-line" style="color:#bfc7d5"><span class="token keyword" style="font-style:italic">bool</span><span class="token plain"> </span><span class="token class-name" style="color:rgb(255, 203, 107)">RaceModel</span><span class="token operator" style="color:rgb(137, 221, 255)">::</span><span class="token function" style="color:rgb(130, 170, 255)">interceptCallSite</span><span class="token punctuation" style="color:rgb(199, 146, 234)">(</span><span class="token keyword" style="font-style:italic">const</span><span class="token plain"> CtxFunction</span><span class="token operator" style="color:rgb(137, 221, 255)">&lt;</span><span class="token plain">ctx</span><span class="token operator" style="color:rgb(137, 221, 255)">&gt;</span><span class="token plain"> </span><span class="token operator" style="color:rgb(137, 221, 255)">*</span><span class="token plain">caller</span><span class="token punctuation" style="color:rgb(199, 146, 234)">,</span><span class="token plain"> </span><span class="token keyword" style="font-style:italic">const</span><span class="token plain"> CtxFunction</span><span class="token operator" style="color:rgb(137, 221, 255)">&lt;</span><span class="token plain">ctx</span><span class="token operator" style="color:rgb(137, 221, 255)">&gt;</span><span class="token plain"> </span><span class="token operator" style="color:rgb(137, 221, 255)">*</span><span class="token plain">callee</span><span class="token punctuation" style="color:rgb(199, 146, 234)">,</span><span class="token plain"> </span><span class="token keyword" style="font-style:italic">const</span><span class="token plain"> llvm</span><span class="token operator" style="color:rgb(137, 221, 255)">::</span><span class="token plain">Function </span><span class="token operator" style="color:rgb(137, 221, 255)">*</span><span class="token plain">originalTarget</span><span class="token punctuation" style="color:rgb(199, 146, 234)">,</span><span class="token plain"> </span><span class="token keyword" style="font-style:italic">const</span><span class="token plain"> llvm</span><span class="token operator" style="color:rgb(137, 221, 255)">::</span><span class="token plain">Instruction </span><span class="token operator" style="color:rgb(137, 221, 255)">*</span><span class="token plain">callsite</span><span class="token punctuation" style="color:rgb(199, 146, 234)">)</span><span class="token plain"> </span><span class="token punctuation" style="color:rgb(199, 146, 234)">{</span><span class="token plain"></span></div><div class="token-line" style="color:#bfc7d5"><span class="token plain">  </span><span class="token punctuation" style="color:rgb(199, 146, 234)">.</span><span class="token punctuation" style="color:rgb(199, 146, 234)">.</span><span class="token punctuation" style="color:rgb(199, 146, 234)">.</span><span class="token plain"></span></div><div class="token-line" style="color:#bfc7d5"><span class="token plain">  </span><span class="token keyword" style="font-style:italic">auto</span><span class="token plain"> </span><span class="token keyword" style="font-style:italic">const</span><span class="token plain"> funcName </span><span class="token operator" style="color:rgb(137, 221, 255)">=</span><span class="token plain"> call</span><span class="token operator" style="color:rgb(137, 221, 255)">-&gt;</span><span class="token function" style="color:rgb(130, 170, 255)">getCalledFunction</span><span class="token punctuation" style="color:rgb(199, 146, 234)">(</span><span class="token punctuation" style="color:rgb(199, 146, 234)">)</span><span class="token operator" style="color:rgb(137, 221, 255)">-&gt;</span><span class="token function" style="color:rgb(130, 170, 255)">getName</span><span class="token punctuation" style="color:rgb(199, 146, 234)">(</span><span class="token punctuation" style="color:rgb(199, 146, 234)">)</span><span class="token punctuation" style="color:rgb(199, 146, 234)">;</span><span class="token plain"></span></div><div class="token-line" style="color:#bfc7d5"><span class="token plain">  </span><span class="token keyword" style="font-style:italic">if</span><span class="token plain"> </span><span class="token punctuation" style="color:rgb(199, 146, 234)">(</span><span class="token class-name" style="color:rgb(255, 203, 107)">PthreadModel</span><span class="token operator" style="color:rgb(137, 221, 255)">::</span><span class="token function" style="color:rgb(130, 170, 255)">isPthreadCreate</span><span class="token punctuation" style="color:rgb(199, 146, 234)">(</span><span class="token plain">funcName</span><span class="token punctuation" style="color:rgb(199, 146, 234)">)</span><span class="token punctuation" style="color:rgb(199, 146, 234)">)</span><span class="token plain"> </span><span class="token punctuation" style="color:rgb(199, 146, 234)">{</span><span class="token plain"></span></div><div class="token-line" style="color:#bfc7d5"><span class="token plain">    </span><span class="token comment" style="color:rgb(105, 112, 152);font-style:italic">// pthread_create passes a single void* as 4th arg</span><span class="token plain"></span></div><div class="token-line" style="color:#bfc7d5"><span class="token plain">    </span><span class="token comment" style="color:rgb(105, 112, 152);font-style:italic">//  pthread_create(null, foo, null, &amp;val)</span><span class="token plain"></span></div><div class="token-line" style="color:#bfc7d5"><span class="token plain">    </span><span class="token comment" style="color:rgb(105, 112, 152);font-style:italic">//  foo(void *arg)</span><span class="token plain"></span></div><div class="token-line" style="color:#bfc7d5"><span class="token plain">    </span><span class="token comment" style="color:rgb(105, 112, 152);font-style:italic">// link 4th arg of caller to 1st arg of callee</span><span class="token plain"></span></div><div class="token-line" style="color:#bfc7d5"><span class="token plain">    PtrNode </span><span class="token operator" style="color:rgb(137, 221, 255)">*</span><span class="token plain">formal </span><span class="token operator" style="color:rgb(137, 221, 255)">=</span><span class="token plain"> </span><span class="token keyword" style="font-style:italic">this</span><span class="token operator" style="color:rgb(137, 221, 255)">-&gt;</span><span class="token function" style="color:rgb(130, 170, 255)">getPtrNode</span><span class="token punctuation" style="color:rgb(199, 146, 234)">(</span><span class="token plain">callee</span><span class="token operator" style="color:rgb(137, 221, 255)">-&gt;</span><span class="token function" style="color:rgb(130, 170, 255)">getContext</span><span class="token punctuation" style="color:rgb(199, 146, 234)">(</span><span class="token punctuation" style="color:rgb(199, 146, 234)">)</span><span class="token punctuation" style="color:rgb(199, 146, 234)">,</span><span class="token plain"> </span><span class="token operator" style="color:rgb(137, 221, 255)">&amp;</span><span class="token operator" style="color:rgb(137, 221, 255)">*</span><span class="token plain">callee</span><span class="token operator" style="color:rgb(137, 221, 255)">-&gt;</span><span class="token function" style="color:rgb(130, 170, 255)">getFunction</span><span class="token punctuation" style="color:rgb(199, 146, 234)">(</span><span class="token punctuation" style="color:rgb(199, 146, 234)">)</span><span class="token operator" style="color:rgb(137, 221, 255)">-&gt;</span><span class="token function" style="color:rgb(130, 170, 255)">arg_begin</span><span class="token punctuation" style="color:rgb(199, 146, 234)">(</span><span class="token punctuation" style="color:rgb(199, 146, 234)">)</span><span class="token punctuation" style="color:rgb(199, 146, 234)">)</span><span class="token punctuation" style="color:rgb(199, 146, 234)">;</span><span class="token plain"></span></div><div class="token-line" style="color:#bfc7d5"><span class="token plain">    PtrNode </span><span class="token operator" style="color:rgb(137, 221, 255)">*</span><span class="token plain">actual </span><span class="token operator" style="color:rgb(137, 221, 255)">=</span><span class="token plain"> </span><span class="token keyword" style="font-style:italic">this</span><span class="token operator" style="color:rgb(137, 221, 255)">-&gt;</span><span class="token function" style="color:rgb(130, 170, 255)">getPtrNode</span><span class="token punctuation" style="color:rgb(199, 146, 234)">(</span><span class="token plain">caller</span><span class="token operator" style="color:rgb(137, 221, 255)">-&gt;</span><span class="token function" style="color:rgb(130, 170, 255)">getContext</span><span class="token punctuation" style="color:rgb(199, 146, 234)">(</span><span class="token punctuation" style="color:rgb(199, 146, 234)">)</span><span class="token punctuation" style="color:rgb(199, 146, 234)">,</span><span class="token plain"> call</span><span class="token operator" style="color:rgb(137, 221, 255)">-&gt;</span><span class="token function" style="color:rgb(130, 170, 255)">getArgOperand</span><span class="token punctuation" style="color:rgb(199, 146, 234)">(</span><span class="token number" style="color:rgb(247, 140, 108)">3</span><span class="token punctuation" style="color:rgb(199, 146, 234)">)</span><span class="token punctuation" style="color:rgb(199, 146, 234)">)</span><span class="token punctuation" style="color:rgb(199, 146, 234)">;</span><span class="token plain"></span></div><div class="token-line" style="color:#bfc7d5"><span class="token plain">    </span><span class="token keyword" style="font-style:italic">this</span><span class="token operator" style="color:rgb(137, 221, 255)">-&gt;</span><span class="token plain">consGraph</span><span class="token operator" style="color:rgb(137, 221, 255)">-&gt;</span><span class="token function" style="color:rgb(130, 170, 255)">addConstraints</span><span class="token punctuation" style="color:rgb(199, 146, 234)">(</span><span class="token plain">actual</span><span class="token punctuation" style="color:rgb(199, 146, 234)">,</span><span class="token plain"> formal</span><span class="token punctuation" style="color:rgb(199, 146, 234)">,</span><span class="token plain"> Constraints</span><span class="token operator" style="color:rgb(137, 221, 255)">::</span><span class="token plain">copy</span><span class="token punctuation" style="color:rgb(199, 146, 234)">)</span><span class="token punctuation" style="color:rgb(199, 146, 234)">;</span><span class="token plain"></span></div><div class="token-line" style="color:#bfc7d5"><span class="token plain">    </span><span class="token keyword" style="font-style:italic">return</span><span class="token plain"> </span><span class="token boolean" style="color:rgb(255, 88, 116)">true</span><span class="token punctuation" style="color:rgb(199, 146, 234)">;</span><span class="token plain"></span></div><div class="token-line" style="color:#bfc7d5"><span class="token plain">  </span><span class="token punctuation" style="color:rgb(199, 146, 234)">}</span><span class="token plain"></span></div><div class="token-line" style="color:#bfc7d5"><span class="token plain">  </span><span class="token punctuation" style="color:rgb(199, 146, 234)">.</span><span class="token punctuation" style="color:rgb(199, 146, 234)">.</span><span class="token punctuation" style="color:rgb(199, 146, 234)">.</span></div></div></div><button type="button" aria-label="Copy code to clipboard" class="copyButton_Ue-o">Copy</button></div></div><h3><a aria-hidden="true" tabindex="-1" class="anchor enhancedAnchor_2LWZ" id="logging"></a>Logging<a class="hash-link" href="#logging" title="Direct link to heading">#</a></h3><p>This directory contains the code used throughout the project for logging.</p><h3><a aria-hidden="true" tabindex="-1" class="anchor enhancedAnchor_2LWZ" id="pointeranalysis"></a>PointerAnalysis<a class="hash-link" href="#pointeranalysis" title="Direct link to heading">#</a></h3><p>This documentation is still in progress.</p><h3><a aria-hidden="true" tabindex="-1" class="anchor enhancedAnchor_2LWZ" id="preprocessing"></a>PreProcessing<a class="hash-link" href="#preprocessing" title="Direct link to heading">#</a></h3><p>This directory contains a number of passes and transformations that make the LLVM IR easier for our tool to analyze.</p><h3><a aria-hidden="true" tabindex="-1" class="anchor enhancedAnchor_2LWZ" id="reporter"></a>Reporter<a class="hash-link" href="#reporter" title="Direct link to heading">#</a></h3><p>This directory contains the code responsible for collecting detected races and formatting them into some output.</p><p>Eventually this directory should contain logic for reporting races in a JSON format, but the reporter is still under development.</p><h3><a aria-hidden="true" tabindex="-1" class="anchor enhancedAnchor_2LWZ" id="trace"></a>Trace<a class="hash-link" href="#trace" title="Direct link to heading">#</a></h3><p>Trace contains the logic for simulating execution and creating a static program trace.</p><p>The important code in this directory are <code>Event</code>, <code>ThreadTrace</code>, and <code>ProgramTrace</code>.</p><p>The <code>Event</code> contains a list of interfaces, similar to the <code>IR.h</code> file (see the <a href="#ir">IR</a> section). Each Event interface wraps an IR type. Where IR interfaces return values in the context of LLVM IR, events return values in the context of the simulated execution.</p><p>As an example, look at the following interface for a read at IR and Event levels.</p><div class="codeBlockContainer_K1bP"><div class="codeBlockContent_hGly cpp"><div tabindex="0" class="prism-code language-cpp codeBlock_23N8 thin-scrollbar"><div class="codeBlockLines_39YC" style="color:#bfc7d5;background-color:#292d3e"><div class="token-line" style="color:#bfc7d5"><span class="token plain" style="display:inline-block">
</span></div><div class="token-line" style="color:#bfc7d5"><span class="token plain"></span><span class="token keyword" style="font-style:italic">class</span><span class="token plain"> </span><span class="token class-name" style="color:rgb(255, 203, 107)">ReadIR</span><span class="token plain"> </span><span class="token punctuation" style="color:rgb(199, 146, 234)">{</span><span class="token plain"></span></div><div class="token-line" style="color:#bfc7d5"><span class="token plain"></span><span class="token keyword" style="font-style:italic">public</span><span class="token operator" style="color:rgb(137, 221, 255)">:</span><span class="token plain"></span></div><div class="token-line" style="color:#bfc7d5"><span class="token plain">    </span><span class="token keyword" style="font-style:italic">virtual</span><span class="token plain"> </span><span class="token keyword" style="font-style:italic">const</span><span class="token plain"> llvm</span><span class="token operator" style="color:rgb(137, 221, 255)">::</span><span class="token plain">Value </span><span class="token operator" style="color:rgb(137, 221, 255)">*</span><span class="token function" style="color:rgb(130, 170, 255)">getReadValue</span><span class="token punctuation" style="color:rgb(199, 146, 234)">(</span><span class="token punctuation" style="color:rgb(199, 146, 234)">)</span><span class="token plain"> </span><span class="token keyword" style="font-style:italic">const</span><span class="token plain"> </span><span class="token operator" style="color:rgb(137, 221, 255)">=</span><span class="token plain"> </span><span class="token number" style="color:rgb(247, 140, 108)">0</span><span class="token punctuation" style="color:rgb(199, 146, 234)">;</span><span class="token plain"></span></div><div class="token-line" style="color:#bfc7d5"><span class="token plain"></span><span class="token punctuation" style="color:rgb(199, 146, 234)">}</span><span class="token punctuation" style="color:rgb(199, 146, 234)">;</span><span class="token plain"></span></div><div class="token-line" style="color:#bfc7d5"><span class="token plain" style="display:inline-block">
</span></div><div class="token-line" style="color:#bfc7d5"><span class="token plain"></span><span class="token keyword" style="font-style:italic">class</span><span class="token plain"> </span><span class="token class-name" style="color:rgb(255, 203, 107)">ReadEvent</span><span class="token plain"> </span><span class="token punctuation" style="color:rgb(199, 146, 234)">{</span><span class="token plain"></span></div><div class="token-line" style="color:#bfc7d5"><span class="token plain"></span><span class="token keyword" style="font-style:italic">public</span><span class="token operator" style="color:rgb(137, 221, 255)">:</span><span class="token plain"></span></div><div class="token-line" style="color:#bfc7d5"><span class="token plain">    </span><span class="token keyword" style="font-style:italic">virtual</span><span class="token plain"> list</span><span class="token operator" style="color:rgb(137, 221, 255)">&lt;</span><span class="token plain">AbstractObj</span><span class="token operator" style="color:rgb(137, 221, 255)">&gt;</span><span class="token plain"> </span><span class="token operator" style="color:rgb(137, 221, 255)">*</span><span class="token function" style="color:rgb(130, 170, 255)">getReadMemory</span><span class="token punctuation" style="color:rgb(199, 146, 234)">(</span><span class="token punctuation" style="color:rgb(199, 146, 234)">)</span><span class="token plain"> </span><span class="token keyword" style="font-style:italic">const</span><span class="token plain"> </span><span class="token operator" style="color:rgb(137, 221, 255)">=</span><span class="token plain"> </span><span class="token number" style="color:rgb(247, 140, 108)">0</span><span class="token punctuation" style="color:rgb(199, 146, 234)">;</span><span class="token plain"></span></div><div class="token-line" style="color:#bfc7d5"><span class="token plain"></span><span class="token punctuation" style="color:rgb(199, 146, 234)">}</span><span class="token punctuation" style="color:rgb(199, 146, 234)">;</span></div></div></div><button type="button" aria-label="Copy code to clipboard" class="copyButton_Ue-o">Copy</button></div></div><p>The ReadIR interface returns the <code>llvm::Value</code> being accessed, but the Event interface returns a list of abstract locations in memory that could potentially be accessed.</p><p>This is the key difference between IR and Events. IR interfaces are just wrappers around LLVM IR instructions, but Events represent actual program events and their simulated execution.</p><p>Lastly, to construct a list of simulated events (e.g. a trace), a function in <code>ThreadTrace</code> takes an entry function as input, traverses the Race IR and builds the simulated trace for a given thread.</p><p>The <code>ProgramTrace</code> class is just a collection of thread traces representing all threads that ran during simulated program execution.</p></div></article><div class="margin-vert--xl"><div class="row"><div class="col"><a href="https://github.com/coderrect-inc/OpenRace/tree/develop/website/docs/doc-overview.md" target="_blank" rel="noreferrer noopener"><svg fill="currentColor" height="1.2em" width="1.2em" preserveAspectRatio="xMidYMid meet" role="img" viewBox="0 0 40 40" class="iconEdit_2_ui" aria-label="Edit page"><g><path d="m34.5 11.7l-3 3.1-6.3-6.3 3.1-3q0.5-0.5 1.2-0.5t1.1 0.5l3.9 3.9q0.5 0.4 0.5 1.1t-0.5 1.2z m-29.5 17.1l18.4-18.5 6.3 6.3-18.4 18.4h-6.3v-6.2z"></path></g></svg>Edit this page</a></div></div></div><div class="margin-vert--lg"><nav class="pagination-nav" aria-label="Docs pages navigation"><div class="pagination-nav__item"><a class="pagination-nav__link" href="/OpenRace/doc-setup-dev-env"><div class="pagination-nav__sublabel">Previous</div><div class="pagination-nav__label">Â« Setting Up Dev Environment</div></a></div><div class="pagination-nav__item pagination-nav__item--next"><a class="pagination-nav__link" href="/OpenRace/doc-adding-new-features"><div class="pagination-nav__sublabel">Next</div><div class="pagination-nav__label">Adding New Features Â»</div></a></div></nav></div></div></div><div class="col col--3"><div class="tableOfContents_35-E thin-scrollbar"><ul class="table-of-contents table-of-contents__left-border"><li><a href="#flow-of-execution" class="table-of-contents__link">Flow of Execution</a><ul><li><a href="#program-trace" class="table-of-contents__link">Program Trace</a></li><li><a href="#analysis" class="table-of-contents__link">Analysis</a></li><li><a href="#race-detection" class="table-of-contents__link">Race Detection</a></li><li><a href="#generate-report" class="table-of-contents__link">Generate Report</a></li></ul></li><li><a href="#project-layout" class="table-of-contents__link">Project Layout</a><ul><li><a href="#analysis-1" class="table-of-contents__link">Analysis</a></li><li><a href="#demangler" class="table-of-contents__link">Demangler</a></li><li><a href="#ir" class="table-of-contents__link">IR</a></li><li><a href="#languagemodel" class="table-of-contents__link">LanguageModel</a></li><li><a href="#logging" class="table-of-contents__link">Logging</a></li><li><a href="#pointeranalysis" class="table-of-contents__link">PointerAnalysis</a></li><li><a href="#preprocessing" class="table-of-contents__link">PreProcessing</a></li><li><a href="#reporter" class="table-of-contents__link">Reporter</a></li><li><a href="#trace" class="table-of-contents__link">Trace</a></li></ul></li></ul></div></div></div></div></main></div></div><footer class="footer footer--dark"><div class="container"><div class="row footer__links"><div class="col footer__col"><h4 class="footer__title">Docs</h4><ul class="footer__items"><li class="footer__item"><a class="footer__link-item" href="/OpenRace/">Style Guide</a></li><li class="footer__item"><a class="footer__link-item" href="/OpenRace/doc-adding-new-features">Contributing</a></li></ul></div><div class="col footer__col"><h4 class="footer__title">More</h4><ul class="footer__items"><li class="footer__item"><a href="https://github.com/coderrect-inc/OpenRace" target="_blank" rel="noopener noreferrer" class="footer__link-item">GitHub</a></li><li class="footer__item"><a href="https://coderrect.com/blog/" target="_blank" rel="noopener noreferrer" class="footer__link-item">Blog</a></li></ul></div></div><div class="footer__bottom text--center"><div class="footer__copyright">Copyright Â© 2021 Coderrect, Inc. Built with Docusaurus.</div></div></div></footer></div>
<script src="/OpenRace/assets/js/styles.e8a566df.js"></script>
<script src="/OpenRace/assets/js/runtime~main.ba43cde6.js"></script>
<script src="/OpenRace/assets/js/main.1a781497.js"></script>
<script src="/OpenRace/assets/js/1.1431b613.js"></script>
<script src="/OpenRace/assets/js/2.c28e7a27.js"></script>
<script src="/OpenRace/assets/js/3.f253f854.js"></script>
<script src="/OpenRace/assets/js/1be78505.ed6ce7d4.js"></script>
<script src="/OpenRace/assets/js/21.1345832e.js"></script>
<script src="/OpenRace/assets/js/935f2afb.fd86e8c5.js"></script>
<script src="/OpenRace/assets/js/17896441.811aa758.js"></script>
<script src="/OpenRace/assets/js/9415349f.d7a4d979.js"></script>
</body>
</html>